---
layout: default  # Inherits from your default layout (e.g., header, footer)
---

<div class="unit-container">  <!-- You can keep this if you like the container style -->
    <div class="unit-header">
        <div class="unit-number">Presentation</div> <!-- You can customize this -->
        <h1 class="unit-title">Course Presentation</h1> <!-- Customize this title -->
    </div>

    <!-- PPT Link Container -->
    <div class="ppt-link-container" style="text-align: center; margin-bottom: 2rem;"> <!-- Added inline style for center alignment -->
        <a class="ppt-link" id="open-ppt" style="display: inline-flex; align-items: center; background-color: var(--secondary); color: white; padding: 1rem 1.5rem; border-radius: var(--border-radius); text-decoration: none; font-weight: 500; transition: var(--transition); box-shadow: var(--shadow); cursor: pointer;">
            <i class="fas fa-file-powerpoint" style="margin-right: 0.75rem; font-size: 1.25rem;"></i>
            View Presentation Slides
        </a>
    </div>

    <!-- PPT Overlay -->
    <div class="overlay" id="ppt-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); backdrop-filter: blur(5px); z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: all 0.3s ease; overflow-y: auto;">
        <div class="ppt-viewer" style="background-color: transparent; border-radius: 0; overflow: visible; position: relative; box-shadow: none; padding: 0; width: 100%; max-width: 100%; height: auto; display: flex; flex-direction: column; align-items: center;">
            <div class="ppt-header" style="display: none;"> <!-- Hidden Header -->
                <h3 style="margin: 0; color: white; font-size: 1.25rem;">Presentation Slides</h3>
                <button class="ppt-close" id="close-ppt" style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; transition: var(--transition);">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="ppt-content" id="ppt-content-scroll" style="max-height: 90vh; overflow-y: auto; padding: 2rem 0; display: flex; flex-direction: column; align-items: center; width: 100%;">
                <div id="slide-container">
                    <!-- Slides will be rendered here -->
                </div>
                <div class="slide-controls" style="display: none;"> <!-- Hidden Controls -->
                    <button class="slide-btn" id="prev-slide" style="background-color: var(--secondary); color: white; border: none; padding: 0.5rem 1rem; border-radius: var(--border-radius); cursor: pointer; transition: var(--transition);">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <span class="slide-counter" id="slide-counter" style="font-weight: 500;">Slides</span>
                    <button class="slide-btn" id="next-slide" style="background-color: var(--secondary); color: white; border: none; padding: 0.5rem 1rem; border-radius: var(--border-radius); cursor: pointer; transition: var(--transition);">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="report-content">
        {{ content }}  <!-- This is where your report content from Markdown will go -->
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const openPptBtn = document.getElementById('open-ppt');
        const closePptBtn = document.getElementById('close-ppt');
        const pptOverlay = document.getElementById('ppt-overlay');
        const slideContainer = document.getElementById('slide-container');
        const slideCounter = document.getElementById('slide-counter');

        function renderAllSlides(slides) { // Function now takes slides array as argument
            slideContainer.innerHTML = '';
            slides.forEach(slide => {
                const slideDiv = document.createElement('div');
                slideDiv.classList.add('ppt-slide');
                slideDiv.setAttribute('style', 'background-color: white; width: 90%; min-height: 500px; display: block; margin-bottom: 2rem; padding: 2rem; border: 1px solid var(--grey-medium); border-radius: var(--border-radius); box-shadow: var(--shadow);');
                slideDiv.innerHTML = `
                    <h2 style="color: var(--primary); margin-bottom: 1rem; text-align: center;">
                        ${slide.title}
                    </h2>
                    <img src="${slide.image}" alt="${slide.title}" style="max-width: 100%; max-height: 80%; border: 1px solid #ddd; display: block; margin: 0 auto 1rem auto;" />
                    <p style="margin-top: 1rem; text-align: center; font-size: 1.25rem;">
                        ${slide.content}
                    </p>
                `;
                slideContainer.appendChild(slideDiv);
            });
            slideCounter.textContent = `${slides.length} Slides`;
        }

        openPptBtn.addEventListener('click', () => {
            pptOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';

            // **Fetch slides.json based on frontmatter data**
            const pptJsonPath = "{{ page.ppt_json_path }}"; // Get path from frontmatter
            if (pptJsonPath) {
                fetch(pptJsonPath)
                    .then(response => response.json())
                    .then(slidesData => {
                        renderAllSlides(slidesData); // Render slides using fetched data
                    })
                    .catch(error => {
                        console.error("Error fetching slides.json:", error);
                        slideContainer.innerHTML = "<p>Failed to load presentation slides.</p>"; // Display error message
                    });
            } else {
                console.error("ppt_json_path not defined in frontmatter.");
                slideContainer.innerHTML = "<p>Presentation path not configured.</p>"; // Display config error
            }
        });

        closePptBtn.addEventListener('click', () => {
            pptOverlay.classList.remove('active');
            document.body.style.overflow = '';
        });

        pptOverlay.addEventListener('click', (e) => {
            if (e.target === pptOverlay) {
                pptOverlay.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        document.addEventListener('keydown', (e) => {
            if (!pptOverlay.classList.contains('active')) return;
            if (e.key === 'Escape') {
                pptOverlay.classList.remove('active');
                document.body.style.overflow = '';
            }
        });
    });
</script>